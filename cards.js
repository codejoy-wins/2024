let player = {
    
}

let enemy = {
   
}

let charizard = {
    "name": "Charizard",
    "health": 220,
    "moves": [
        {
            "name": "flamethrowerr",
            "damage": 25,
            "fullname": "Flamethrower",
        },
        {
            "name": "dragonslam",
            "damage": 85,
            "fullname": "Dragon Slam"
        },
        {
            "name": "firespinner",
            "damage": 100,
            "fullname": "Fire Spin"
        },
        {
            "name": "fly",
            "damage": 70,
            "fullname": "Fly",
        },
    ],
    "type": "fire",
    "weakness": "water",
    "picture": "charizard2.jpg",
    "maxhp": 220,
    "color": "red"
}

let raichu = {
    "name": "Raichu",
    "health": 110,
    "moves": [
        {
            "name": "thunderwave",
            "damage": 0,
            "fullname": "Thunder Wave",
        },
        {
            "name": "headbutt",
            "damage": 70,
            "fullname": "Headbutt"
        },
        {
            "name": "thunderbolt",
            "damage": 95,
            "fullname": "Thunderbolt"
        },
        {
            "name": "volt tackle",
            "damage": 135,
            "fullname": "Volt Tackle",
        },
    ],
    "type": "electric",
    "weakness": "rock",
    "picture": "raichu.jpg",
    "maxhp": 110,
    "color": "gold"
}

let blastoise = {
    "name": "Blastoise",
    "health": 200,
    "moves": [
        {
            "name": "waterpulse",
            "damage": 50,
            "fullname": "Water Pulse"
        },
        {
            "name": "bodyslam",
            "damage": 40,
            "fullname": "Body Slam"

        },
        {
            "name": "hydropump",
            "damage": 60,
            "fullname": "Hydro Pump"

        },
        {
            "name": "harden",
            "damage": 0,
            "fullname": "Harden",
        },
    ],
    "type": "water",
    "weakness": "electric",
    "picture": "blastoise.jpg",
    "maxhp": 200,
    "color": "blue"
}

let pikachu = {
    "name": "Pikachu",
    "health": 50,
    "moves": [
        {
            "name": "spark",
            "damage": 20,
            "fullname": "Spark"
        },
        {
            "name": "quickattack",
            "damage": 40,
            "fullname": "Quick Attack"

        },
        {
            "name": "thunderbolt",
            "damage": 60,
            "fullname": "Thunderbolt"

        },
        {
            "name": "thunder",
            "damage": 95,
            "fullname": "Thunder",
        },
    ],
    "type": "electric",
    "weakness": "rock",
    "picture": "pikachu.jpg",
    "maxhp": 50,
    "color": "gold"
}

let absol = {
    "name": "Absol",
    "health": 170,
    "moves": [
        {
            "name": "swordsdance",
            "damage": 0,
            "fullname": "Sword's Dance"
        },
        {
            "name": "quickattack",
            "damage": 40,
            "fullname": "Quick Attack"

        },
        {
            "name": "slash",
            "damage": 80,
            "fullname": "Slash"

        },
        {
            "name": "aerialace",
            "damage": 60,
            "fullname": "Aeriel Ace",
        },
    ],
    "type": "dark",
    "weakness": "ghost",
    "picture": "absol.jpg",
    "maxhp": 170,
    "attackpower": 1,
    "defense": 1,
    "color": "black"
}

let lapras = {
    "name": "Lapras",
    "health": 90,
    "moves": [
        {
            "name": "icebeam",
            "damage": 90,
            "fullname": "Ice Beam",
        },
        {
            "name": "dragonbreath",
            "damage": 55,
            "fullname": "Dragon Breath"
        },
        {
            "name": "blizzard",
            "damage": 120,
            "fullname": "Blizzard"
        },
        {
            "name": "aurorabeam",
            "damage": 70,
            "fullname": "Aurora Beam",
        },
    ],
    "type": "ice",
    "weakness": "fire",
    "picture": "lapras.jpg",
    "maxhp": 90,
    "color": "blue"
}

let mew = {
    "name": "Mew",
    "health": 30,
    "moves": [
        {
            "name": "icebeam",
            "damage": 90,
            "fullname": "Ice Beam",
        },
        {
            "name": "dragonbreath",
            "damage": 55,
            "fullname": "Dragon Breath"
        },
        {
            "name": "blizzard",
            "damage": 120,
            "fullname": "Blizzard"
        },
        {
            "name": "aurorabeam",
            "damage": 70,
            "fullname": "Aurora Beam",
        },
    ],
    "type": "psychic",
    "weakness": "ghost",
    "picture": "mew.jpg",
    "maxhp": 30,
    "color": "purple"
}
let legendarymew = {
    "name": "LegendaryMew",
    "health": 320,
    "moves": [
        {
            "name": "icebeam",
            "damage": 90,
            "fullname": "Ice Beam",
        },
        {
            "name": "fireblast",
            "damage": 150,
            "fullname": "Fire Blast"
        },
        {
            "name": "blizzard",
            "damage": 120,
            "fullname": "Blizzard"
        },
        {
            "name": "psybeam",
            "damage": 70,
            "fullname": "Psybeam",
        },
    ],
    "type": "psychic",
    "weakness": "ghost",
    "picture": "mewog.jpg",
    "maxhp": 320,
    "color": "purple"
}
let zapdos = {
    "name": "Zapdos",
    "health": 110,
    "moves": [
        {
            "name": "thunder",
            "damage": 90,
            "fullname": "Thunder",
        },
        {
            "name": "zapcannon",
            "damage": 150,
            "fullname": "Zap Cannon"
        },
        {
            "name": "drillpeck",
            "damage": 80,
            "fullname": "Drill Peck"
        },
        {
            "name": "fly",
            "damage": 70,
            "fullname": "Fly",
        },
    ],
    "type": "electric",
    "weakness": "rock",
    "picture": "zapdos.jpg",
    "maxhp": 110,
    "color": "gold"
}
let ninetales = {
    "name": "Ninetales",
    "health": 145,
    "moves": [
        {
            "name": "flamethrower",
            "damage": 90,
            "fullname": "Flamethrower",
        },
        {
            "name": "rest",
            "damage": 0,
            "healthgain": 140,
            "fullname": "Rest"
        },
        {
            "name": "dig",
            "damage": 60,
            "fullname": "Dig"
        },
        {
            "name": "takedown",
            "damage": 100,
            "fullname": "Take Down",
        },
    ],
    "type": "fire",
    "weakness": "water",
    "picture": "ninetales.jpg",
    "maxhp": 145,
    "color": "red"
}

let venasaur = {
    "name": "Venasaur",
    "health": 190,
    "moves": [
        {
            "name": "razorleaf",
            "damage": 75,
            "fullname": "Razor Leaf",
        },
        {
            "name": "solarbeam",
            "damage": 120,
            "fullname": "Solar Beam"
        },
        {
            "name": "megadrain",
            "damage": 60,
            "healthgain": 30,
            "fullname": "Mega Drain"
        },
        {
            "name": "gigadrain",
            "damage": 80,
            "healthgain": 40,
            "fullname": "Giga Drain",
        },
    ],
    "type": "grass",
    "weakness": "fire",
    "picture": "venasaur.jpg",
    "maxhp": 190,
    "color": "green"
}

let onix = {
    "name": "Onix",
    "health": 100,
    "moves": [
        {
            "name": "rockslide",
            "damage": 85,
            "fullname": "Rock Slide",
        },
        {
            "name": "bodyslam",
            "damage": 50,
            "fullname": "Body Slam"
        },
        {
            "name": "harden",
            "damage": 0,
            "fullname": "Harden"
        },
        {
            "name": "earthquake",
            "damage": 100,
            "fullname": "Earthquake",
        },
    ],
    "type": "rock",
    "weakness": "grass",
    "picture": "onix.jpg",
    "maxhp": 100,
    "color": "dark"
}

let haunter = {
    "name": "Haunter",
    "health": 60,
    "moves": [
        {
            "name": "hypnosis",
            "damage": 0,
            "fullname": "Hypnosis",
        },
        {
            "name": "dreameater",
            "damage": 50,
            "fullname": "Dream Eater"
        },
        {
            "name": "psychic",
            "damage": 85,
            "fullname": "Psychic"
        },
        {
            "name": "shadowball",
            "damage": 80,
            "fullname": "Shadow Ball",
        },
    ],
    "type": "ghost",
    "weakness": "rock",
    "picture": "haunter.jpg",
    "maxhp": 60,
    "color": "dark"
}




let pokemon = [
    charizard,
    blastoise,
    pikachu,
    absol,
    lapras,
    mew,
    legendarymew,
    zapdos,
    ninetales,
    venasaur,
    onix,
    haunter,
    raichu
]

let enemies = [
    legendarymew,
    blastoise,
    venasaur,
    zapdos,
    onix,
    absol,
    raichu
]

let players = [
    charizard,
    lapras,
    ninetales,
    haunter,
    pikachu,
    mew
]

let deadenemies = [

]

let deadplayers = [
    
]

function randomize(){
    console.log("randomizing");
    let x = Math.floor(Math.random()*players.length);
    player = players[x];
    let y = Math.floor(Math.random()*enemies.length);
    enemy = enemies[y];
}

function initialize(){
    console.log("initializing");
    // choose random pokemon
    randomize();
    // use chosen pokemon's pictures
    document.getElementById("enemy_img").innerHTML=`
    <img src="static/img/${enemy.picture}" alt="enemy" class="card">
    `
    document.getElementById("player_img").innerHTML=`
        <img src="static/img/${player.picture}" alt="player" class="card">
    `
    // use chosen pokemon's health
    document.getElementById("player_health").innerHTML=`
        <div class="clear">${player.name}'s Health: ${player.health} HP</div>
    `
    document.getElementById("enemy_health").innerHTML=`
        <div class="clear">${enemy.name}'s Health: ${enemy.health} HP</div>
    `
    // show player's pokename about moveset
    document.getElementById("mover").innerHTML=`
            <p>${player.name}'s Moves</p>
        `
    // show player's moveset
    for(var i =0; i < player.moves.length; i++){
        document.getElementById("playermove").innerHTML+=`
            <div class="${player.color}">
            <div class="supermove" onclick=attack("${player.name}","${player.moves[i].name}",${player.moves[i].damage},${player.moves[i].healthgain})>
            <div class= "move">${player.moves[i].fullname}</div>
            <div class= "move">${player.moves[i].damage}</div>
            </div>
            </div>
        `
    }
    
}
// run initial function
initialize();

function reset(){
    console.log("resetting");
    // reset variables
    deadenemies =[];
    deadplayers =[];

    // randomly select new pokemon
    randomize();
    // log new pokemon to console
    console.log(`player is ${player.name} and enemy is ${enemy.name}`);
    // display chosen pokemon pictures
    document.getElementById("enemy_img").innerHTML=`
    <img src="static/img/${enemy.picture}" alt="enemy" class="card">
    `
    document.getElementById("player_img").innerHTML=`
        <img src="static/img/${player.picture}" alt="player" class="card">
    `
    //reset player and enemy health to maxhp
    for(var i=0; i< players.length; i++){
        players[i].health = players[i].maxhp;
        enemies[i].health = enemies[i].maxhp;
    }
    player.health = player.maxhp;
    enemy.health = enemy.maxhp;

    document.getElementById("info").innerHTML=``;
    document.getElementById("enemy_health").innerHTML=`
    <div class="clear">${enemy.name}'s Health: ${enemy.health} HP</div>
    `;
    document.getElementById("player_health").innerHTML=`
    <div class="clear">${player.name}'s Health: ${player.health} HP</div>
    `
    document.getElementById("playermove").innerHTML=``;
    document.getElementById("mover").innerHTML=`
        <p>${player.name}'s Moves</p>
    `
    for(var i =0; i < player.moves.length; i++){
        document.getElementById("playermove").innerHTML+=`
            <div class="${player.color}">
            <div class="supermove" onclick=attack("${player.name}","${player.moves[i].name}",${player.moves[i].damage},${player.moves[i].healthgain})>
            <div class= "move">${player.moves[i].fullname}</div>
            <div class= "move">${player.moves[i].damage}</div>
            </div>
            </div>
        `
    }
}
function retaliate(i){
    if(enemy.health>0){
        console.log(`retaliating ${i}`);
        document.getElementById("info").innerHTML+=`
        <p>${enemy.name} used ${enemy.moves[i].fullname}</p>
        <p>It did ${enemy.moves[i].damage} damage!!</p>
        `
        player.health-=enemy.moves[i].damage

        if(enemy.moves[i].healthgain){
            enemy.health+=enemy.moves[i].healthgain;
            if(enemy.health>enemy.maxhp){
                console.log("cannot go above max");
                enemy.health=enemy.maxhp;
            }
            console.log(`Enemy gained back ${enemy.moves[i].healthgain} health!`);
            updateEnemy();
            document.getElementById("info").innerHTML+=`
            <p>${enemy.name} used ${enemy.moves[i].fullname}</p>
            <p>It did ${enemy.moves[i].damage} damage!!</p>
            <p>Enemy gained back ${enemy.moves[i].healthgain} health!</p>
            `
        }

        if(player.health >0){
            document.getElementById("player_health").innerHTML=`
            <div class="clear">${player.name}'s Health: ${player.health}</div>
            `
        }else{
            document.getElementById("player_health").innerHTML=`
            <div class="clear">${player.name} Fainted</div>
            `
            playerFainted();
        }
        
    }

    
}

function attack(name, move, dmg, healthgain){
    if(player.health<=0 || enemy.health<=0){
        document.getElementById("info").innerHTML +=`
    <p>
        ${name} cannot attack
    </p>
    `
    }else{
        // rest code here later
        
        console.log(`${name} used ${move}`);
        console.log(`It caused ${dmg} damage!`);
        document.getElementById("info").innerHTML +=`
        <p>
            ${name} used ${move}
        </p>
        <p>
            It caused ${dmg} damage!
        </p>
        `
        if(healthgain){
            console.log("health gain xp");
            player.health=player.maxhp;
            document.getElementById("info").innerHTML+=`
            <p>${name} recovered HP! to ${player.maxhp}</p>
            `
        }
        enemy.health-=dmg;
        if(enemy.health<=0){
            document.getElementById("enemy_health").innerHTML=`
            <div class="clear">${enemy.name} Fainted</div>
        `
        enemy_fainted();
        }
        else{
            document.getElementById("enemy_health").innerHTML=`
            <div class="clear">${enemy.name}'s Health: ${enemy.health} HP</div>
        `
        }
        let z = Math.floor(Math.random()*enemy.moves.length);
        console.log(`z is ${z}`);
        retaliate(z);
    }
}

function updateEnemy(){
    console.log(`updating ${enemy.name}`);
    // update enemy picture
    document.getElementById("enemy_img").innerHTML=`
    <img src="static/img/${enemy.picture}" alt="enemy" class="card">
    `
    // update enemy health display
    document.getElementById("enemy_health").innerHTML=`
    <div class="clear">${enemy.name}'s Health: ${enemy.health} HP</div>
    `;
    document.getElementById("info").innerHTML=`
    <p>Enemy sent out ${enemy.name}!</p>
    `
}
function chooseRandomEnemy(){
    console.log(`deadenemies length is ${deadenemies.length}`);
    if(deadenemies.length >=enemies.length){
        console.log("end of enemy team");
        document.getElementById("info").innerHTML+=`
        <h1>You won</h1>
        `;
        document.getElementById("enemy_health").innerHTML=`
        <h1>Pokemon Master</h1>
        `
        document.getElementById("mover").innerHTML=`
        <p onclick=reset() >Play Again?</p>
        `;
        document.getElementById("playermove").innerHTML=``;

    }else{
        let k = Math.floor(Math.random()*enemies.length);
        if(enemies[k].health<=0){
            console.log(`${enemies[k].name} is already dead`);
            chooseRandomEnemy();
        }else{
            if(enemy==enemies[k]){
                console.log("choosing another random");
                chooseRandomEnemy();
            }else{
                enemy = enemies[k];
                console.log(`${enemy.name} was chosen`);
                updateEnemy();
            }
        }
    }
    
}

function enemy_fainted(){
    console.log("enemy fainted");
    console.log(`${enemy.name} fainted`);
    deadenemies.push(enemy);
    for(var i =0; i <deadenemies.length; i++){
        console.log(`${deadenemies[i].name} is very dead`);
    }
    setTimeout(function(){
        console.log("getting new enemy");
        newEnemy();
    }, 3500);
}

function newEnemy(){
    console.log("new enemy inbound");
    document.getElementById("enemy_health").innerHTML=`
    <div class="clear">New Enemy Coming Out! </div>
    `;
    document.getElementById("info").innerHTML+=`
    <p>${enemy.name} fainted</p>
    `
    setTimeout(() => {
        console.log("xp");
        chooseRandomEnemy();
    }, 1500);
}
function playerFainted(){
    console.log(`${player.name} has fainted`);
    deadplayers.push(player);
    document.getElementById("mover").innerHTML=`Choose your next pokemon`;
    document.getElementById("playermove").innerHTML=`
    
    `
    for(var i =0; i<players.length; i++){
        if(players[i].health>0){
            document.getElementById("deck").innerHTML+=`
            <p onclick=newplayer(${i})>${players[i].name} has ${players[i].health} health</p>
            <img onclick=newplayer(${i}) src="static/img/${players[i].picture}" alt="player" class="card2">
            `;
        }else{
            console.log("xpxpxp");
        }
        console.log(`dead players length is at ${deadplayers.length}`);
        if(deadplayers.length >=players.length){
            console.log("you lose");
            document.getElementById("mover").innerHTML=`
            <p onclick=reset() >Try Again?</p>
            `
        }
    }
    ;
}
function newplayer(i){
    console.log(`choosing ${players[i].name} to keep fighting!`);
    player = players[i];
    updatePlayer();
}

function updatePlayer(){
    console.log(`updating ${player.name}`);
    // update player picture
    document.getElementById("player_img").innerHTML=`
    <img src="static/img/${player.picture}" alt="player" class="card">
    `
    // update player health display
    document.getElementById("player_health").innerHTML=`
    <div class="clear">${player.name}'s Health: ${player.health} HP</div>
    `;
    document.getElementById("info").innerHTML=`
    <p>player sent out ${player.name}!</p>
    `
    document.getElementById("deck").innerHTML=``;
    document.getElementById("mover").innerHTML=`
        <p>${player.name}'s Moves</p>
    `
    for(var i =0; i < player.moves.length; i++){
        document.getElementById("playermove").innerHTML+=`
            <div class="${player.color}">
            <div class="supermove" onclick=attack("${player.name}","${player.moves[i].name}",${player.moves[i].damage},${player.moves[i].healthgain})>
            <div class= "move">${player.moves[i].fullname}</div>
            <div class= "move">${player.moves[i].damage}</div>
            </div>
            </div>
        `
    }
}